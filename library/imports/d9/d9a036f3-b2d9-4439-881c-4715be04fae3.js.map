{"version":3,"sources":["../../../../../assets/game/script/assets/game/script/player.js"],"names":["mvs","require","GLB","cc","Class","extends","Component","properties","label","Label","init","userId","playerId","score","userInfo","id","self","rotateID","setInterval","Game","GameManager","gameState","GameState","Over","clearInterval","Play","engine","sendFrameEvent","JSON","stringify","action","PLAYER_ROTATION_EVENT","rotation","node","start","targetRotation","setRotation","addScore","string","update","dt","lerp","onDestroy"],"mappings":";;;;;;AAAA,IAAIA,MAAMC,QAAQ,SAAR,CAAV;AACA,IAAIC,MAAMD,QAAQ,KAAR,CAAV;AACAE,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;AAELC,gBAAY;AACRC,eAAOL,GAAGM;AADF,KAFP;AAKLC,UAAM,cAASC,MAAT,EAAiB;AAAA;;AACnB,aAAKC,QAAL,GAAgBD,MAAhB;AACA,aAAKE,KAAL,GAAa,CAAb;AACA,YAAIX,IAAIY,QAAJ,CAAaC,EAAb,KAAoB,KAAKH,QAA7B,EAAuC;AACnC,gBAAII,OAAO,IAAX;AACA,iBAAKC,QAAL,GAAgBC,YAAY,YAAM;AAC9B,oBAAIC,KAAKC,WAAL,CAAiBC,SAAjB,KAA+BC,UAAUC,IAA7C,EAAmD;AAC/CC,kCAAc,MAAKP,QAAnB;AACH,iBAFD,MAEO;AACH,wBAAGE,KAAKC,WAAL,CAAiBC,SAAjB,KAA+BC,UAAUG,IAA5C,EAAkD;AAC9CzB,4BAAI0B,MAAJ,CAAWC,cAAX,CAA0BC,KAAKC,SAAL,CAAe;AACrCC,oCAAQ5B,IAAI6B,qBADyB;AAErCC,sCAAUhB,KAAKiB,IAAL,CAAUD;AAFiB,yBAAf,CAA1B;AAIH;AACJ;AACJ,aAXe,EAWb,GAXa,CAAhB;AAYH;AACJ,KAvBI;;AAyBLE,WAAO,iBAAW;AACd,aAAKC,cAAL,GAAsB,KAAKF,IAAL,CAAUD,QAAhC;AACH,KA3BI;;AA6BLI,eA7BK,uBA6BOJ,QA7BP,EA6BiB;AAClB,aAAKG,cAAL,GAAsBH,QAAtB;AACH,KA/BI;AAiCLK,YAjCK,oBAiCIxB,KAjCJ,EAiCW;AACZ,aAAKA,KAAL,IAAcA,KAAd;AACA,aAAKL,KAAL,CAAW8B,MAAX,GAAoB,KAAKzB,KAAzB;AACH,KApCI;AAsCL0B,UAtCK,kBAsCEC,EAtCF,EAsCM;AACP,YAAItC,IAAIY,QAAJ,CAAaC,EAAb,KAAoB,KAAKH,QAA7B,EAAuC;AACnC,iBAAKqB,IAAL,CAAUD,QAAV,GAAqB7B,GAAGsC,IAAH,CAAQ,KAAKR,IAAL,CAAUD,QAAlB,EAA4B,KAAKG,cAAjC,EAAiD,KAAKK,EAAtD,CAArB;AACH;AACJ,KA1CI;AA4CLE,aA5CK,uBA4CO;AACRlB,sBAAc,KAAKP,QAAnB;AACH;AA9CI,CAAT","file":"player.js","sourceRoot":"../../../../../assets/game/script","sourcesContent":["var mvs = require(\"Matchvs\");\nvar GLB = require(\"Glb\");\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        label: cc.Label\n    },\n    init: function(userId) {\n        this.playerId = userId;\n        this.score = 0;\n        if (GLB.userInfo.id === this.playerId) {\n            var self = this;\n            this.rotateID = setInterval(() => {\n                if (Game.GameManager.gameState === GameState.Over) {\n                    clearInterval(this.rotateID);\n                } else {\n                    if(Game.GameManager.gameState === GameState.Play) {\n                        mvs.engine.sendFrameEvent(JSON.stringify({\n                            action: GLB.PLAYER_ROTATION_EVENT,\n                            rotation: self.node.rotation\n                        }));\n                    }\n                }\n            }, 200);\n        }\n    },\n\n    start: function() {\n        this.targetRotation = this.node.rotation;\n    },\n\n    setRotation(rotation) {\n        this.targetRotation = rotation;\n    },\n\n    addScore(score) {\n        this.score += score;\n        this.label.string = this.score;\n    },\n\n    update(dt) {\n        if (GLB.userInfo.id !== this.playerId) {\n            this.node.rotation = cc.lerp(this.node.rotation, this.targetRotation, 10 * dt);\n        }\n    },\n\n    onDestroy() {\n        clearInterval(this.rotateID);\n    }\n\n});\n"]}